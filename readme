# ğŸ§¾ Multi-Tenant Expense Management API

A secure, scalable, multi-tenant Expense Management API built with Laravel 10+. Supports company-specific user management, role-based access control (RBAC), expense tracking, audit logging, job queues (Redis), and scheduled weekly reports.

---

## ğŸš€ Features

- ğŸ” **API Authentication** using Laravel Sanctum
- ğŸ¢ **Multi-Tenant Architecture** â€” each user belongs to a company
- ğŸ‘¥ **Role-Based Access Control (RBAC)** â€” Admin, Manager, Employee
- ğŸ“Š **Expense Management** â€” create, update, delete, and view expenses per company
- ğŸ“œ **Audit Logging** â€” logs updates for accountability
- â° **Queued Jobs** â€” Redis-powered queue for background tasks
- ğŸ—“ï¸ **Scheduled Tasks** â€” weekly expense report dispatch to company admins
- ğŸ“¬ **Email Notifications** â€” admin reports via Mailpit (or configured SMTP)
- âš™ï¸ **API Testing** â€” Postman collection included for easy testing

---

## ğŸ“¦ Tech Stack

- **Laravel 10+**
- **Sanctum** for API authentication
- **MySQL** for data storage
- **Redis** for queue management
- **Mailpit** (or any SMTP) for testing emails
- **Postman** for API testing

---

## ğŸ“‚ Project Structure
app/ â”œâ”€â”€ Http/ â”‚ â””â”€â”€ Controllers/ â”‚ â”œâ”€â”€ Api/ â”‚ â”‚ â””â”€â”€ AuthController.php â”‚ â”‚ â””â”€â”€ ExpenseController.php â”‚ â”‚ â””â”€â”€ ... â”œâ”€â”€ Jobs/ â”‚ â””â”€â”€ SendWeeklyExpenseReport.php â”œâ”€â”€ Models/ â”‚ â””â”€â”€ Company.php â”‚ â””â”€â”€ Expense.php â”‚ â””â”€â”€ User.php â”‚ â””â”€â”€ AuditLog.php â””â”€â”€ ... routes/ â””â”€â”€ api.php


## âš™ï¸ Installation

```bash
git clone https://github.com/yourname/multi-tenant-expense-management.git
cd multi-tenant-expense-management
composer install
cp .env.example .env
php artisan key:generate
php artisan migrate --seed
```

### Start Redis
```bash```
```
brew services start redis
```

### Run Queue Worker
In your Terminal, run

```bash```
```
php artisan schedule:run
```

## ğŸ”‘ API Authentication (Sanctum)
- Login via /api/login to receive a token
- Pass token in Authorization header as Bearer {token} for protected routes

## ğŸ“— API Endpoints Overview
Method	Endpoint	Description
- `POST	/api/login` â†’	User login
- `POST	/api/register` â†’	Admin registers new user
- `GET /api/users` â†’ List users (Admins only)
- `POST /api/users` â†’ Add user (Admins only)
- `PUT /api/users/{id}` â†’ Update user role (Admins only)
- `GET /api/expenses` â†’ List (by company, paginated, searchable by title/category)
- `POST /api/expenses` â†’ Create (restricted to logged-in userâ€™s company)
- `PUT /api/expenses/{id}` â†’ Update (Managers & Admins only)
- `DELETE /api/expenses/{id}` â†’ Delete (Admins only)


## ğŸ“Š Audit Logging
Every expense update logs:
- old values
- new values
- user_id
- company_id
- action (e.g. update)

Stored in audit_logs table.


## ğŸ“ˆ Weekly Report Job
Fetches expenses for each company from past 7 days
- Calculates total
- Emails report to all Admins in the company
- Runs via Laravel Scheduler


## ğŸ“ License
MIT

## ğŸ‘¨â€ğŸ’» Author
Jonathan Audu @https://github.com/JonathanAudu

